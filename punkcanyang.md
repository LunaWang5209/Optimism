---
timezone: Asia/Shanghai
---

> 请在上边的 timezone 添加你的当地时区，这会有助于你的打卡状态的自动化更新，如果没有添加，默认为北京时间 UTC+8 时区
> 时区请参考以下列表，请移除 # 以后的内容


---

# {Punkcan}

1. Optimism 治理新手...
2. 你认为你会完成本次残酷学习吗？
	- 应该是可以的

## Notes

<!-- Content_START -->

### 2025.01.06

后续的笔记我都尽可能白话

### 用最白话的方式，解释Optimism是什么？

假设以太坊是一条高速公路，但是他限速100，當大家都想在上面開車時，就會開始塞車，導致速度變慢、而且上公路要费用，如果人太多就只能把手續費變貴，让出的起较高手续的车子先上。

Optimism 就是在高速公路旁邊蓋了一條新的快速道路。
虽然他也有限速，但是设计不同，所以他限速更高，例如300，這條快速道路的目標是讓大家可以在上面快速、便宜地開車（進行交易），然後再把結果匯回高速公路（以太坊），以確保安全。

把结果存回以太坊的这个动作很重要，因为Optimism跟L1相比，并没有所谓的验证者，所以他仰赖以太坊上面的安全机制，来确保他的数据是可信任的。

### Optimistic Rollup

Optimism 使用一種叫做「Optimistic Rollup」的技術。

就是先假設所有交易都是沒問題的，除非有人跳出來說有問題。

如果沒人說有問題，那這些交易就被視為有效。然後再將很多筆交易「捲起來」打包成一批，再送回以太坊。

### OP Stack

Optimism 的技術是基於 OP Stack 開發的，OP Stack 是一套開源的軟體組件，可以讓大家更容易建立新的 Layer 2 區塊鏈。

**主要特点：**
- 将区块链的各个功能拆分成独立的模块，如数据存储、交易排序、执行等。开发者可以根据需要选择、替换或修改这些模块。
- 支持不同的虚拟机（如 EVM），开发者可以根据应用需求选择最适合的执行环境。
- 支持不同链之间的互操作性。

### Superchain愿景

Optimism 的目標是建立一個「Superchain」，也就是一個由很多條鏈組成的網路，這些鏈都可以共享安全、溝通層和開發工具。

另外Optimism 有自己的代幣，叫做 OP 代幣。OP 代幣持有者可以參與 Optimism 的治理，也就是決定 Optimism 的未來發展方向。

---

### OP 的 Gas 是怎么计算的？

在 Optimism 网络中，交易费用（Gas 费）主要由两部分组成：

1. L2 执行费用：这部分费用与在以太坊主网（L1）上执行交易类似，按照交易在 L2 上执行所消耗的 Gas 量计算。由于 L2 的 Gas 价格较低，这部分费用通常占总费用的比例很小。
2. L1 数据费用：这是将 L2 交易数据打包并提交到以太坊主网时产生的费用。具体而言，Optimism 会将多笔 L2 交易打包成一个批次（batch），并以 calldata 的形式提交到 L1。每个字节的 calldata 在 L1 上都会产生相应的 Gas 费用。因此，交易数据越大，L1 数据费用就越高。

L1 数据费用通常占总交易费用的绝大部分，超过 90%。
Optimism 通过数据压缩等技术手段，努力减少提交到 L1 的数据量，降低用户的交易成本。

为了将交易数据从 Layer 2（L2）提交到以太坊主网（Layer 1，L1），需要支付一定的费用。为确保这些费用的合理性并应对 L1 Gas 价格的波动，Optimism 引入了以下参数：

- **固定开销（Fixed Overhead）**：每笔交易都会产生一个固定的基础费用，用于覆盖将交易数据打包并提交至 L1 的基本处理成本。例如，Optimism 曾将固定开销从 2750 Gas 减少至 2100 Gas，以降低用户的交易费用。
- **费用比例系数（Fee Scalar）**：这是一个动态调整的系数，用于应对 L1 Gas 价格的波动。当 L1 Gas 价格上涨时，费用比例系数可以提高，以确保有足够的资金覆盖提交数据的成本；当 L1 Gas 价格下降时，该系数可以降低，以减少用户的交易费用。Optimism 曾将费用比例系数从 1.5 降低到 1.24，以优化用户的交易成本。

公式：`L1 数据费用 = 费用比例系数 × L1 Gas 价格 ×（交易数据大小 + 固定开销）`

举例：`L1 数据费用 = 1.24 × L1 Gas 价格 ×（交易数据大小 + 2100）`

### 2025.01.07

### Plasma 和 Optimistic rollups 的区别和历史

Plasma 是由以太坊创始人 Vitalik Buterin 和 Joseph Poon 于 2017 年提出的一种扩容解决方案。通过在主链上建立多个子链，来将大量计算和数据处理转移到子链，从而减轻主链负担。

交易放到子链上处理，只有子链的最终结果提交到以太坊主链，基本上就是验证状态，例如哈希根之类的

这样就可以把计算的负担分到子链上。

但这里我不太理解是不是大家太相信密码学了，对于这种显著的问题会避而不见，就是如果只储存验证状态，只能相信子链不会出问题。

原本机制是认为子链即便出问题，还是有退回机制跟挑战机制（质疑交易错误）
但等于把诈骗证明跟退回机制也分散各个子链，还不能全状态回滚，这样反而提高了难度跟安全风险。

目前看下来Plasma跟最大的差别在于
Plasma把验证机制交给子链，验证结果交给主网（这样数据存的少，计算也少）
Rollups把验证机制交给主网，也不需要另外处理验证结果

也因为Plasma的验证方式，导致他的退出机制更加复杂，不过还好现在大家都不太用了。

对应Plasma的诸多问题，Rollups有点像是针对这些问题的改良版本，优化了解决了 Plasma 的一些设计问题，并引入了新的机制，使得数据验证和状态更新更高效。

### Rollups优化了哪些部分？

目前比较常讲到的两种Rollups：Optimistic Rollups 和 ZK Rollups 

两者都是将数据压缩后储存在主链上（用calldata的方式），而且都确保主链上存储的数据确保了所有交易可以被重新验证，无需依赖L2数据，减少了验证的复杂性。

### 验证机制效率

#### **Optimistic Rollups**

- 假设所有交易都是有效的（所以叫乐观Optimistic），只有在争议发生时才进行欺诈证明。
- 挑战期内仅验证有争议的部分，其他交易无需逐笔验证（Plasma 需要在欺诈证明中逐笔回溯）。
- 数据直接存储在主链，不需要从链下重新获取数据。

#### **ZK Rollups**

- 使用零知识证明，在提交交易时就生成一个证明，证明所有交易都是有效的。
- 主链只需要验证零知识证明，就可以确认交易是否正确，无需逐笔检查交易。
- 零知识证明的验证时间极短。
- 这边可以理解到ZK并不是为了隐私，而是为了降低验证成本

也因为完成证明的条件更加简单，退出机制更短




### 2025.01.08

### ZK Rollups 如何产生证明？，具体来说主链上跟链下个别储存了什么？产生流程是什么？

这次主题是Optimistic，所以我们不解释ZK是什么，反正解释了我自己也看不懂。
具体储存如下：
- 主链：
	- 存储压缩后的交易数据（calldata）
	- 零知识证明（ZK Proof），这个证明是确保交易数据是有效的
	-  Layer 2 状态树的根哈希值，而且只存最后的状态（这个不细说了，区块链的基础，区块链本身就是依赖根哈希值去确认整条链的数据未篡改）
- 链下：具体交易和完整状态变化，可以理解成原本在L1交易时有什么，他就有什么（大多都有，但他没有验证者资料，因为L2不完全是透过验证节点处理验证，有些L2用排序器）

具体流程：
- 交易提交到 L2 网络
- 交易并处理状态更新
- L2 网络将多个交易打包成一个批次
- L2 网络计算出新的状态树的根哈希
- 将所有交易压缩成 calldata 格式，准备提交到主链
- 生成零知识证明
	- **输入**：当前状态根哈希、交易批次、最终状态根哈希
	- 输出证明，证明从初始状态到最终状态的所有交易处理都是正确的
- L2 将以下内容提交到主链
	- 压缩的交易数据
	- 零知识证明
	- 最终的状态根哈希

Optimistic则是假设所有提交的交易都是合法的，主链只记录交易摘要和数据，而不逐笔验证。

不像ZK还要产出证明，因此效率更高，成本更低。

至于为什么Optimistic不做验证呢？在逻辑上个人觉得比较像是成本后置的概念。

ZK是每个打包都需要验证，成本在发生挑战（有人质疑数据有误）前就已经有了，但实际上链上发生挑战的频率极低（至少目前上很少发生）

后续如果发生时再进行诈欺证明就可以了，这样可以有效降低成本。

具体流程：
- 交易提交到 L2 网络
- L2 处理交易并更新状态
- L2 将多个交易打包成一个批次，生成新的状态根哈希值。
- L2 将以下内容提交到主链
	- 压缩的交易数据（calldata）。
	- 更新后的状态摘要（Merkle Root）。
- 主链不验证交易，默认假设提交的数据和状态是正确的

是不是简易很多？手续费也降很多（实际操作会明显感受到手续费的差异）

### Tokenomics（代币经济）

鉴于 OP 一直没涨，我们有必要了解一下OP的代币经济，不过今天花太多时间理解Rollups的流程了，我先抄写一下OP目前官方的代币经济

1. OP 代币的初始总供应量为 4,294,967,296 个，并计划以每年 2% 的速度通胀。

2. 代币分配：
	1. 生态系统基金（25%）用于直接资助推动生态系统扩展的社区和公司，包括治理基金、合作伙伴基金、种子基金等。
	2. 追溯性公共产品资助（20%）：通过 Citizens’ House 分发，旨在奖励对生态系统有积极贡献的项目和个人。
	3. 用户空投（19%）：分多次向 Optimism 和以太坊社区的成员分配，第一次空投占 5%，未来还将空投 14%。
	4. 核心贡献者（19%）：分配给帮助将 Optimism 从概念变为现实的人员，所有代币都将受到锁定期的约束。
	5. 投资者（17%）：用于奖励资助 Optimism 发展的投资者，所有代币都将受到锁定期的约束。

3. 治理机制：
	1. 双院制治理体系：由 Token House 和 Citizens’ House 共同管理（必考！丢笔，你可以不懂反捕获委员会，但不能不懂双院制）。
	2. Token House：由 OP 持有者组成，负责项目激励的分配、协议升级等决策投票（目前只能投票跟请愿不能提案）。
	3. Citizens’ House：负责追溯性公共产品资金的分配，成员通过不可转让的 NFT 授予，集合会随着时间的推移而增长，另外部分跟规章政策相关的核心提案，也会需要Citizens’ House投票。
	4. Optimism 基金会
		1. 能提案，但不能投票
		2. 负责推动 Optimism 网络的早期发展（非完全去中心化之前）和技术方向
		3. 

4. 激励机制：
	1. Sequencer 收入再分配：网络交易费用和 Sequencer 收入主要用于资助公共产品，从而创造生态系统价值并推动对区块空间的需求（这个要研究一下跟追溯性公共产品资助是不是同一个）。




### 2025.01.09

#### 代币经济跟OP的币价问题

虽然币圈往往不讲供需，但我们从供需的角度看看OP的币价问题：

OP除了治理之外，就是用来激励，但激励又会让市场进行抛售，进而压制币价，长期以来说这其实是健康的，毕竟一个币的流动性跟他的经济模型健康程度呈现正相关性。

OP的供应量月约42.9亿，并每年增发2%，这是预期OP生态规模增长下，为了维持币价健康的一种设计，当然这种增发如果在未来发生失衡的状态，

虽然激励会带来一定的抛压，但是也会促进生态增长，简单来说，币价如果缓慢下跌（排除行情的影响），最主要的原因反倒是生态增长不够快造成的。

目前币价压制的主要几个因素：
- 初始供应量大，释放节奏较快。
- 年度通胀持续稀释。
- 激励，空投和锁仓解锁带来的抛压。

再加上预期抛压持续存在，因此投机需求也会下降，资本进场的意愿也会下降。

几个未来可能提高币价的可能：
- 更大比例的空投，投资，激励等OP释出后，市场对抛售的预期下降
- OP有更多的应用，例如支付等等
- 生态增长，成为L2的寡头
- 进行销毁（但目前想不到销毁的理由）

至于当Gas 币，会有以下几个问题：
- L2 Gas 费用有大部分是要缴回L1，如果用OP当Gas，缴回L1还要换算，会产生更大的波动
- 超级链如果人人都要用自己的代币当本币，超级链之间的汇率，Gas等等就会变的很混乱，不易超级链的推广，OP开这个头，可能会将整个超级链生态带往混乱
- 不用ETH当本币了还算是L2吗？意识形态问题，当然还是可以用Rollups机制，但整个意识形态会发生纷争
- 替代方案：可以用OP成为Gas Account的通货，也就是说用户可以用OP购买Gas Account的额度，但实际上交易还是扣Gas Account的ETH
- 根据Q老师解释，技术不是问题
- 根据Bruce老师解释，任何问题都可以协调

以上都不是无法克服，如果用OP做Gas币，可以提升OP的消耗，有助于OP的币价提升，但万一后面接着生态混乱纷争等等，生态可能会因此受伤萎缩，反而对币价是不好的

我觉得如果只有利好没有利空，不会一直到现在都不用OP当本币......

### Rollups 的 Stages 框架

Stages 框架是Vitalik Buterin 和 Rollups 开发团队提出一种引导Rollups 发展的概念：

- #### Stage 0: Minimal Rollup：
	- 实行基础功能
	- 数据可用
	- 验证也可用
- #### Stage 1: Data Availability Independence
	- 减少对以太坊主链的依赖，数据产生更大的扩展能力
	- 提高处理能力
- #### Stage 2: Decentralized Sequencers
	- Sequencer 不再由单一实体控制，而是通过共识机制（如 PoS）或去中心化网络运行
- #### Stage 3: Interoperability
	- 不同 Rollups 之间实现互操作性，支持跨 Rollup 资产和数据流转，也就是Superchain现在要做的事情
- #### Stage 4: Full Decentralization
	- Rollups 完全实现去中心化，所有核心组件（Sequencer、数据可用性、验证者）均由分布式网络管理。

话说现在大部分的Rpllups L2 ，多处于 Stage 1 的阶段，Optimistic 目前有计划性的往2跟3前进中。

这个1,2,3不一定是依序进行，也可能并行，例如从讨论上来看，Optimistic 的 Superchain的进度是要比 Decentralized Sequencers 要早些启动的

### 2025.01.10

谈谈EIP-4488跟EIP-4844
EIP-4488 和 EIP-4844 都是为降低 Layer 2 Rollups 的交易成本而设计的提案

EIP-4488
- 降低 Rollups 提交数据到以太坊主链的成本。
- 把数据的存储费用（calldata）从每字节 16 gas 降到 3 gas，同时限制每个区块的数据量。
- 降低 Rollups 的交易成本，大约减少 3-5 倍。

EIP-4844
- 引入一种新的交易类型，专门为 Rollups 存储临时数据（叫 blobs）。
- 数据不长期存储在主链，只验证可用性，减少存储压力。
- 大幅降低 Rollups 成本，可减少 10-100 倍
- 为未来分片扩展（Danksharding）奠定基础

EIP-4844数据不长期存储在主链，那是存储在哪？
- 当 Rollups 把交易数据提交到L1时，所有交易细节会被打包成一个“blob”。
- blobs 是随交易一起提交的临时数据块，它们只需要一两周内存储在以太坊网络的节点中。
- 在数据存储的短期内，所有验证者和节点都能访问 blobs 数据。
- Rollups 数据在 blobs 中存储时间有限，仅用于在挑战期内验证数据。
- 一旦挑战期结束（通常是 7 天），这些数据的验证需求就结束，存储也可以被释放。
- 主链只存储 blobs 的摘要（例如 Merkle 根），用于长期证明 Rollups 的状态是正确的。
- 完整数据的长期存储由 Rollups 或第三方数据网络。

除了Plasma之外，还有一种叫Validium的机制
与 ZK Rollups 类似，它也利用了 零知识证明来确保安全性和正确性。
Validium 和 ZK Rollups 的关键区别在于 数据可用性（Data Availability） 的处理方式。

**Validium 的核心特点**
- Validium 将交易数据存储在链下，不是像 ZK Rollups 那样将数据压缩后存储在以太坊主链上。
- 主链仅存储状态的证明和摘要，链下的数据由专门的 数据可用性委员会（Data Availability Committee, DAC） 来管理。
- Validium 使用零知识证明技术（如 zk-SNARK 或 zk-STARK），主链通过验证证明来确保链下处理的交易是正确的。
- 由于数据存储不依赖主链，Validium 的数据存储成本更低，扩展性更高，可以处理数千笔交易每秒。

但是！
跟Plasma的安全性源自于子链的管理，Validium 的安全性部分依赖于数据可用性委员会，用户必须信任 DAC 不会恶意丢失或拒绝提供链下数据。

跟Plasma不同的是，Validium因为采用了ZKP验证，也可以用主链验证状态正确性

简单来说就是一个再验证部分往ZK靠拢的Plasma，可以做到Plasma的高吞吐低成本，安全性又比Plasma更加可控一些。

但是因为他的设计更加中心化，通常用来处理支付或游戏等不需要长期确保价值的场景



### 2025.01.11


### 2025.01.12



<!-- Content_END -->
