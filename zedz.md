---
timezone: Asia/Shanghai
---

---

# {Zedz}

1. 自我介绍
zedz，8月份参与过三次共学，区块链爱好者，重新回来学习。

2. 你认为你会完成本次残酷学习吗？
会

## Notes

<!-- Content_START -->

### 2025.01.06

Optimistic Rollup 概述
Optimism 是一种叫做 “Optimistic Rollup” 的技术。它的核心思想就是，Optimism 这个区块链依赖于另外一个已经存在的区块链（比如以太坊）的安全性和共识机制。简单来说，Optimism 就是把以太坊当作“妈妈区块链”，而它自己是“孩子区块链”。

1. 区块存储
Optimism 把数据存储到以太坊的区块链上，但是采用了特别的方式，这样做可以省钱。数据一旦提交，就无法再修改或删减，这样保证了数据的安全性和完整性。

2. 区块生产
在 Optimism 上，区块的生产是由一个叫做 “sequencer” 的角色来负责。它的工作包括：

确认交易并更新区块链的状态。
创建和执行 Optimism 上的区块。
将交易提交到以太坊区块链上。
这些区块每两秒钟就会生成一次，不管它们是否有交易，或者是空的。

3. 交易提交
交易有两种方式进入 Optimism：

直接提交：这种交易便宜，因为不需要通过以太坊。但是，这些交易不能保证完全公平，因为只有 sequencer 知道它们。
通过以太坊提交：这种方式可以确保交易公平，避免 sequencer 偷偷删减交易。
4. 区块执行
区块的执行由一个叫做 “执行引擎” 来完成。它通过和其他引擎交换信息来更新状态，也可以通过区块链本身来获取信息。虽然后者比较慢，但它能够保证数据的安全性。

5. ETH 和代币的跨链转账
Optimism 允许在不同区块链之间转账，比如从以太坊转到 Optimism，或者从 Optimism 转回以太坊。这个转账过程通过“桥接”来完成。你可以把代币从以太坊转到 Optimism，也可以把它们从 Optimism 取回。

6. 从以太坊到 Optimism
在 Optimism 里面，从以太坊转到 Optimism 的交易叫做 “存款”。这些存款会进入一个特定的区块，几分钟后，Optimism 就会确认这个存款。

7. 从 Optimism 到以太坊
从 Optimism 转到以太坊的操作叫做 “提取”，需要分为三个步骤：

首先发起提取请求。
等待一个新的根状态提交到以太坊。
最后，确认提取请求。
8. 故障证明
在 Optimism 中，数据提交到以太坊后不会立即验证它的正确性，而是会在一定时间内等待挑战。如果没人提出挑战，数据就被认为是正确的；如果有人挑战成功，数据就会被撤回。

### 2025.01.07

1. Layer 2扩容技术概述
随着以太坊的使用量激增，去中心化金融（DeFi）和NFT市场的发展都对以太坊的吞吐量提出了更高的要求。然而，以太坊每秒只能处理不到20笔交易，且高昂的gas费用限制了更多用户的参与。因此，Layer 2 解决方案应运而生，它们能够在以太坊主链（Layer 1）上执行一些计算和存储操作，从而降低费用和提高效率。

Layer 2的扩容方案：

Optimistic Rollup
ZK Rollup
Plasma
Validium
2. 各解决方案的交易费用
文章中的一个核心点是 Gas 费用。下面总结了不同扩容技术方案的费用差异：

ZK Rollup：在 zkSync 上，每笔交易的成本有两个组成部分：链下部分（存储 + SNARK 生成成本）和链上部分（验证成本）。总体来看，ZK Rollup 的交易成本较低，且随着以太坊网络更新，EIP-4488等提案将进一步降低交易费用。

Optimistic Rollup：采用“乐观假设”，所有交易假设是合法的，只有在挑战的情况下才进行验证。Optimism的费用相较于ZK Rollup较高，但其安全性和兼容性方面表现出色。Optimism 在交易中有两个主要成本来源：

L2执行费：这是交易在Layer 2上的执行费用。
L1数据/安全费用：Optimism的所有交易都需提交到以太坊主链，这会引入额外的费用。
zkPorter：zkSync 2.0 提出的 zkPorter 技术通过降低数据可用性成本来大幅降低交易费用。由于zkPorter不依赖于链上数据可用性，它的交易费用预计会比ZK Rollup便宜得多（约为0.03美元）。

3. 交易费用的影响因素
EIP-4488：该提案将大幅降低 Layer 2 Rollup 的成本，特别是对 calldata（数据传输）带来了显著的影响。预计将大幅降低 non-zero calldata 的gas费用。

ZK Rollup和Optimistic Rollup的区别：ZK Rollup通常提供更低的费用和更高的吞吐量，尤其在转账ETH和ERC20代币时。Optimistic Rollup则更侧重于兼容性和安全性，但相较之下，费用较高。

4. ZK Rollup的优势
高扩展性：ZK Rollup在理论上能够提供比Ethereum主网高100倍以上的TPS。例如，ZK Rollup最大可以实现每秒11,818笔交易，远高于Ethereum的101笔TPS。
低成本：由于压缩了数据量，ZK Rollup的费用显著低于传统Ethereum交易。
安全性：ZK Rollup能够通过零知识证明（SNARK）确保安全性，并且其数据验证不依赖于Layer 2的信任模型，而是依赖于Ethereum主链的安全性。
5. 未来发展
随着 Layer 2 方案的不断发展，我们可能会看到更多的应用迁移到 Layer 2 上，以获得更好的用户体验。例如，Uniswap等去中心化交易所（DEX）可能会在ZK Rollup和zkPorter上部署智能合约，提供更低成本的交易。

总结
ZK Rollup 是目前最具扩展性和最低成本的解决方案，尤其适合需要高吞吐量的应用（如DeFi和NFT）。
Optimistic Rollup 提供了更强的兼容性和安全性，适用于更广泛的用例，但其费用相对较高。
zkPorter 预计会成为一种重要的低费用方案，尤其在不需要链上数据可用性的情况下，交易费用可以进一步降低。
随着技术进步和以太坊扩展性提案（如EIP-4488和EIP-4844）的实施，未来Layer 2的费用将大幅降低，从而推动以太坊生态的广泛应用。

---

Rollups的三阶段发展框架
Rollups是以太坊扩展的一种技术，但它们需要逐步去中心化，才能完全做到安全和可靠。为了更好地理解rollups的成熟度，我们将它们分为三个阶段：

第一阶段：完全“辅助轮”
控制权在运营者手中：在这个阶段，rollup完全由运营者控制。
数据根状态在L1上发布：rollup的状态信息会被发布到以太坊主链（L1），方便后期验证和恢复。
透明性高：有软件可以用来重建rollup的状态，任何人都可以审查这个过程，增加系统的可信度。
第二阶段：有限的“辅助轮”
由智能合约治理：rollup开始由智能合约来治理，但可能会保留一个“安全委员会”，用来修复一些问题。
存在欺诈证明系统：如果有不正确的状态根，系统会用欺诈证明来处理。
允许外部验证：至少有5个外部参与者可以提交欺诈证明，保证系统的透明性。
用户可以自己退出：用户在不想继续使用时，可以自己把资产取出，不依赖运营者。
有安全委员会：这个委员会至少有8个成员，通过集体投票来决定系统的重要问题。
第三阶段：完全去中心化
完全去中心化的欺诈证明系统：任何人都可以提交欺诈证明，不再有任何限制。
用户可以有更长时间退出：如果不喜欢系统的升级或变化，用户至少可以有30天的时间退出。
安全委员会的作用有限：安全委员会只能处理系统中出现的严重错误，不能随便干预系统的其他部分。
总结
这个框架帮助我们理解rollups的成长过程。从完全由运营者控制到完全去中心化，它的逐步发展确保了系统的安全和去信任化。这有助于我们评估rollups是否已经准备好成为一个完全安全、无需信任的以太坊扩展解决方案。

### 2025.01.08

摘抄自共学同学的笔记：

- MEV
- Stage
- Tokenomic
- EIP4844

MEV 的定义
Maximal Extractable Value MEV 是利用区块链中交易排序的灵活性，来获取额外经济收益的行为。

MEV 的来源
MEV 的主要来源是 区块链中交易的非确定性排序 ，即矿工或验证者可以决定：

哪些交易进入区块 。
交易的排序顺序 。
是否包含某些交易 。
这种控制能力使得矿工/验证者可以通过交易排序获得经济收益。

MEV 的常见场景
以下是一些典型的 MEV 操作场景：

1. 套利（Arbitrage）
**描述：**在不同去中心化交易所（如 Uniswap 和 SushiSwap）之间，价格可能存在差异，矿工可以通过调整交易顺序执行套利交易。
**例子：**如果在 Uniswap 上 ETH 的价格是 $1000，而在 SushiSwap 上是 $1050，矿工可以优先执行套利交易，赚取差价。
2. 清算（Liquidation）
**描述：**在借贷协议（如 Aave、Compound）中，当借款人的抵押品价值不足时，清算者可以赚取清算奖励。矿工可以优先执行这些清算交易。
**例子：**用户 A 的贷款被触发清算，矿工插入清算交易以获得清算奖励。
3. 三明治攻击（Sandwich Attack）
**描述：**这是 DeFi 中一种常见的 MEV 攻击方式，矿工通过在目标交易前后插入交易来获利。
步骤：
在目标交易之前发送一个买单，抬高价格。
等目标交易执行后，再发送一个卖单，获利。
**结果：**目标交易者将以更高的价格完成交易，而矿工获得利润。
MEV 的影响
1. 对用户的影响
负面：
用户可能因为 MEV 行为（如三明治攻击）而遭受经济损失。
网络拥堵时，Gas 费用可能因 MEV 的竞争而大幅上升。
正面：
某些 MEV 行为（如套利和清算）可以提升市场效率。
2. 对网络的影响
安全性： 高额的 MEV 收益可能导致矿工/验证者之间的不公平竞争，甚至诱发攻击（如自私挖矿）。
去中心化： MEV 的集中化可能会削弱区块链的去中心化特性。
如何缓解 MEV？
为减少 MEV 对生态的负面影响，社区提出了多种解决方案：

1. Flashbots
**描述：**Flashbots 是一个专门用于缓解 MEV 的项目，允许用户和矿工通过专用通道提交交易，避免公开的 Gas 战争。
**作用：**提供一个透明且高效的 MEV 提交系统，减少用户损失。
2. PBS（Proposer-Builder Separation）
**描述：**在以太坊的 PoS 机制下，将区块的提议者（Proposer）与构建者（Builder）分离，降低单一验证者的 MEV 控制力。
3. 去中心化排序协议
**描述：**使用去中心化的排序协议，确保交易顺序的公平性，例如 CowSwap 提出的公平排序机制。
BedRock
Bedrock 是一种与区块链相关的术语，尤其在 Optimism 生态系统中，它特指 Optimism Bedrock ，即 Optimism 网络的下一代升级框架。它是一个技术更新，旨在提高网络的性能、兼容性和可扩展性，同时降低复杂性和成本。

Stage
Stage 的介绍：https://medium.com/l2beat/introducing-stages-a-framework-to-evaluate-rollups-maturity-d290bb22befe

stage简单看来就是对于Rollup系统的一个评估体系。

那三阶段分别是什么？

第0阶段：作者自娱自乐级。我开发了一个rollup链，我要开源一个“挖矿软件”让别人也能共同维护链上（状态根）。

第1阶段：我把软件的功能转移到智能合约上，就比如说状态根的验证这个环节，不再是在各个节点本地验证了，转而用智能合约。同时保留了安全委员会维护bug。注意需要有完整的验证,欺诈证明,退出机制且不受安全委员会干扰。

第2阶段：rollup完全由合约控制，充足的推出时间（对于不想升级软件的节点），安全委员会仅解决链上裁决的正确性错误，用户免受治理攻击。

那op属于哪一个？

stage1 https://www.tradingview.com/news/cointelegraph:124d04da9094b:0-optimism-reaches-stage-1-decentralization-implementing-fault-proofs/


stage的意思，事物发展的阶段，等级，在这里就是一个判断框架，目的就是来判断评估 Rollups 项目，处于那个阶段，以便让用户知道，它的去中心化程度。分为以下三个阶段：

第0️⃣阶段：由操作员运行，有一个开源可用软件。

第1️⃣阶段：由操作员运行，升级为智能合约运行，保留一个安全委员会，解决少部分问题，OP是用的故障证明。

第2️⃣阶段：完全由智能合约运行，安全委员会非必要不干涉，除了重大问题。

tokenomic
1. OP 代币的主要用途

OP 代币在 Optimism 网络中的主要用途包括：

治理：OP 代币持有者可以参与 Optimism 网络的治理。通过投票，社区成员可以决定关于网络升级、协议改进、资金分配等重要事项。
激励：为了激励网络中的参与者，OP 代币会用于奖励验证节点、开发者和用户。
费用支付：OP 代币用于支付网络中的交易费用。
2. OP 代币的分配

OP 代币的初始分配计划如下：

空投（Airdrop）：OP 代币通过空投的方式分发给早期用户，旨在激励社区参与，并帮助更广泛的用户了解和使用 Optimism。
社区奖励：一部分 OP 代币会分配给社区成员作为激励措施，激励他们参与 Optimism 的治理和网络安全等活动。
团队和合作伙伴：一部分 OP 代币会分配给 Optimism 的创始团队、投资者和合作伙伴。
DAO资金池：Opitmism 将建立一个去中心化自治组织（DAO），其资金池用于资助网络的持续发展和其他生态系统的支持。
3. 治理机制

Optimism 的治理机制是基于 Optimism Collective，这是一个由代币持有者和项目参与者共同治理的机制。具体治理过程如下：

OP 代币持有者：通过持有 OP 代币，用户可以对提案进行投票，决策包括协议升级、资金分配、奖励机制等。

治理的两阶段流程

：

意向阶段（Idea Phase）：社区成员提出改进提案，并进行讨论。
决策阶段（Decision Phase）：最终的治理提案将在 DAO 里进行投票，所有 OP 持有者都有参与权。
4. 经济激励

OP 代币的经济激励设计包括：

L2 网络安全：为了确保 Optimism 的安全，验证者和节点运营商需要提供质押的 OP 代币作为担保。任何恶意行为或欺诈行为将导致质押的 OP 代币被扣除。
奖励机制：参与 Optimism 网络的开发者、社区成员、以及其他网络提供者将根据他们的贡献（如代码贡献、开发 dApp、参与治理等）获得 OP 代币奖励。
5. 代币的通胀机制

激励分配

：OP 代币的分配并非一次性完成，而是采取

逐步释放

的方式，以确保代币的供应能根据网络的需求逐渐增加。激励措施包括：

每年一定数量的 OP 代币会释放给参与网络治理、开发和维护的社区成员。
部分 OP 代币将作为奖励发放给网络节点和安全参与者，确保网络的持续运作和安全。
6. 长期目标和去中心化进程

Optimism 希望通过以下措施逐步实现全面去中心化：

更多参与：OP 代币的治理机制将逐步增强社区的参与度，确保更多的用户、开发者和节点有机会对网络进行治理。
去中心化开发：随着网络的发展，更多的开发者和第三方应用将能够在 Optimism 上进行部署，进一步推动其生态系统的发展。
逐步减少中心化控制：通过 DAO 机制，Optimism 将逐步减少对中心化控制的依赖，确保协议的完全去中心化。
7. 持续发展与生态建设

Optimism 还通过 OP基金会 和其他生态系统项目来推动生态建设。代币的激励和治理机制将鼓励更多的开发者参与到 Optimism Rollup 上，带来更多的应用场景和用户。

EIP4844
blob不参与以太坊状态计算！ 用状态根代替

简单说来就是引入Blob存储并降低其gas

提高 Layer 2 扩展性：减少通过以太坊主链传递数据的成本，尤其是 Optimistic Rollups 和 ZK-Rollups。

降低交易费用：通过引入新的交易格式，减少 Rollup 相关的交易费用，这将极大地影响到网络上交易的成本，特别是 Rollup 中的数据传输。

为分片（Sharding）铺路：为未来的以太坊 分片机制（即以太坊 2.0）做好准备，进一步提升网络的扩展性。

### 2025.01.09

总结自共学同学的笔记：

Optimism 的代币 OP 是它整个系统的重要部分，就像一个国家的货币，主要用于激励用户、发展生态系统和治理决策。以下是主要内容的简单说明：

1. OP的分配
一共有42.9亿个OP，每年还会新增2%，有点像每年印一点新钱。
代币分给了以下几类人：
生态基金（25%）： 用于支持做项目的公司和社区，比如合作伙伴、种子基金等。
公共产品奖励（20%）： 奖励对Optimism生态有帮助的人或项目。
用户空投（19%）： 分给Optimism用户和社区成员，这部分会分批发放。
核心贡献者（19%）： 给开发和建设Optimism的团队，他们的代币有锁定期。
投资者（17%）： 投资者提供资金支持，代币也有锁定期。
2. 治理机制（双院制）
Optimism的治理分成两部分：

Token House： 持有OP的人可以参与投票，决定项目激励分配和协议升级。
Citizens’ House： 通过NFT选举的成员，负责分配公共产品资金。
这两部分共同管理，确保决策合理透明。
3. OP的价格问题
目前OP币价不高，主要原因是：

初期发行量大，释放代币速度快。
每年新增2%代币，稀释价值。
激励和空投导致很多人卖掉代币，增加抛售压力。
**但长期看，这种“健康流动性”有助于生态发展。**如果生态规模增长得够快，币价会更稳定甚至上涨。

4. 如何提升OP的价值？
减少抛售预期： 如果空投、激励分完，抛售压力会降低。
更多应用场景： 比如用OP支付等，增加需求。
生态发展： 如果Optimism能成为行业龙头（L2巨头），币价会随生态提升。
销毁代币： 减少供应，但目前没有明确理由这么做。
5. 为什么OP不是Gas费？
OP作为Gas费有一些问题：

复杂度增加： L2上的费用最终要交给L1（以太坊），如果用OP中间还要换算，可能引发波动和麻烦。
超级链的困扰： 如果每个链都用自己的代币，链与链之间会产生混乱，比如汇率问题。
理念冲突： ETH是以太坊生态的基础货币，改变它可能引发争议。
折中方案： 允许用户用OP充值“Gas账户”，实际交易还是用ETH，这样可以增加OP的使用但不破坏整体生态。

总结：
Optimism 的代币经济设计是为了激励生态发展，但目前的挑战在于生态扩展速度不够快，导致币价表现一般。如果生态规模能快速增长，OP的需求也会提高，币价才会有更大潜力上涨。

### 2025.01.10

Derivation Pipeline（派生管道）
派生管道 是 OP Stack 协议的核心组成部分，负责处理和验证 Optimism 网络中的交易。它通过从交易和批次中派生一致的区块链状态，确保了区块链的完整性和安全性。

派生管道的关键功能：
批次提交和排序
交易由 sequencer 收集并排序成批次，然后将这些批次提交到 Layer 1 (L1) 进行最终确认和包含到区块链中。

安全头和不安全区块
派生管道保持两种类型的区块：

安全头（Safe Head）：代表在 L1 上已经确认的最新状态。
不安全区块（Unsafe Blocks）：这些区块已经排序，但还未在 L1 上确认。
回滚和恢复
如果超过了排序时间窗口（通常为 12 小时），而没有找到有效的批次提交到 L1，派生管道会回滚所有那个时间段的“不安全区块”。然后，管道会使用一个默认的空区块来继续处理新的交易。

Sequencer 窗口
Sequencer 窗口 定义了批次提交并确认在 L1 上的最大时间。如果这个时间窗口被超过，派生管道会采取措施，确保网络的完整性和持续运行。

例如：

在 12 小时的排序窗口内，如果没有找到有效批次提交到 L1，派生管道会回滚不安全区块，并使用一个默认区块来继续处理。
如果将窗口增加到 24 小时，节点可以等待更长时间再回滚不安全区块，但这可能会带来额外的挑战，比如资源压力增大，处理更大批次变得更困难。
配置和调整
sequencerWindowSize 参数是在部署配置时设定的，并且一旦确定后可能很难更改。因此，链的运营者需要仔细考虑合适的窗口大小，以平衡网络性能和稳定性。

### 2025.01.11

摘抄自共学同学的笔记：

Bedrock 是什么？

AI：Bedrock 是 OP Stack 的一次重大升级，于 2023 年 6 月推出。主要改进包括：

重写了节点软件，提高了性能和可靠性
降低了交易费用，通过优化数据压缩和批处理
改进了与以太坊的兼容性，支持更多 EVM 操作码
简化了系统架构，使得维护和升级更容易
增强了模块化设计，便于其他项目复用代码
TODO 看一下数据压缩规则以及原始数据 https://specs.optimism.io/protocol/derivation.html#batch-submission-wire-format

AI：OP 的数据压缩主要通过以下方式实现：

Channel 格式：将多个交易打包成 channel
压缩算法：使用 zlib 进行数据压缩
批处理提交：多个 channel 组合成 batch，再提交到 L1
数据编码：使用高效的二进制格式，减少存储空间
去重优化：相似交易数据会被优化存储
OP Gas fee 的运转流程 https://docs.optimism.io/stack/transactions/fees：

EVM 等效，类似以太坊的运行方式，但是有一些不同
实际 gas = L2 执行 gas + L1 数据保存费用
L2 执行 gas 的计算规则以太坊一样，所以执行的 gas 一样，也使用 EIP-1559 设置 base fee 等。但是 gas 的价格是非常低的
OP 进行了一些小参数调整，所以有更短的区块时间
The eth_maxPriorityFeePerGas RPC method can be used to estimate a priority fee that will get your transaction included quickly.
商业模式就是赚 gas fee 的利差，自己的成本低，然后收取一定的 gas，把 L1 的 gas 成本扣掉就可以盈利了。所以交易和使用量就是最关键的指标和数据

AI：OP 的节点网络包括：

主要 Sequencer：由 OP 基金会运营的中心化节点
验证节点：任何人都可以运行，目前约有数百个
归档节点：存储完整历史数据的节点
RPC 节点：提供 API 服务的节点

AI：OP Sequencer 的运行情况：

部署位置：在 AWS 云服务上运行，有多区域备份
攻击应对：
如果 Sequencer 被攻击，用户仍可通过 L1 提交交易
基金会可以快速切换备用 Sequencer
验证节点网络保证数据安全性
风险缓解：
正在推进 Sequencer 去中心化
多重签名控制关键更新
完善的灾难恢复机制

### 2025.01.12

### 2025.01.13

### 2025.01.14

### 2025.01.15

### 2025.01.16

### 2025.01.17

### 2025.01.18

### 2025.01.19

### 2025.01.20

### 2025.01.21

### 2025.01.22

### 2025.01.23

### 2025.01.24

### 2025.01.25

### 2025.01.26


<!-- Content_END -->
